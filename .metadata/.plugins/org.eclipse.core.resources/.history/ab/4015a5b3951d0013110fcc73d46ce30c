package laundrylist.controller;

import laundrylist.model.State;
import laundrylist.model.JSONController.JSONPostTask;
import laundrylist.model.JSONController.JSONRequest;
import laundrylist.view.ExploreActivity;
import laundrylist.view.LoginActivity;
import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;
import android.widget.Toast;

public class LoginController {
	private LoginActivity view;

	public LoginController(LoginActivity activity) {
		this.view = activity;
	}

	public void onLoginPressed() {
		Object[] data = new Object[2];
		data[0] = "jason.haury@gmail.com";
		data[1] = "asdf";
		new JSONPostTask().execute(data);
	}

	private class LoginTask extends AsyncTask<Object[], Void, String> {

		@Override
		protected String doInBackground(Object[]... params) {
			// TODO Auto-generated method stub
			State.getInstance().getJSONController()
					.request(JSONRequest.LOGIN, params);
			return "";
		}

		@Override
		protected void onPostExecute(String result) {
			// do something
			if (result.equals("")) {
				view.startActivity(new Intent(view, ExploreActivity.class));
				view.finish();
			} else {
				Context context = getApplicationContext();
				int duration = Toast.LENGTH_SHORT;

				Toast toast = Toast.makeText(context, result, duration);
				toast.show();
			}
		}

	}
}
